# ğŸ“‹ 6ì£¼ì°¨: HTTP ìš”ì²­ ë°ì´í„° ì²˜ë¦¬ êµ¬í˜„

## ğŸ¯ ìˆ˜ì •ëœ ëª©í‘œ

- **HTTP ìš”ì²­ ë°ì´í„° ì™„ì „ ì²˜ë¦¬**: GET/POST/PUT/DELETE ëª¨ë“  ìš”ì²­ íƒ€ì… ì§€ì›
- **Spring MVC í•µì‹¬ ì–´ë…¸í…Œì´ì…˜** êµ¬í˜„: `@RequestParam`, `@PathVariable`, `@RequestBody`
- **íŒŒë¼ë¯¸í„° ë°”ì¸ë”©**: ë¬¸ìì—´ â†’ Java ê°ì²´ ìë™ ë³€í™˜
- **ì‹¤ì œ ë™ì‘ ê²€ì¦**: Postman/ë¸Œë¼ìš°ì €ë¡œ ëª¨ë“  ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸

---

## ğŸ“š ë³‘í–‰ í•™ìŠµ (20ë¶„)

### **í•µì‹¬ ê°œë… ì´í•´:**

- **HTTP ìš”ì²­ì˜ 3ê°€ì§€ ë°ì´í„° ì „ë‹¬ ë°©ì‹**
  - Query Parameter: `?name=john&age=25`
  - Path Variable: `/users/123`
  - Request Body: JSON, Form ë°ì´í„°
- **Java íƒ€ì… ë³€í™˜** (`String` â†’ `int`, `Long` ë“±)
- **JSON íŒŒì‹±** ê¸°ì´ˆ
- **HTTP ë©”ì†Œë“œë³„ íŠ¹ì„±** (GETì€ Body ì—†ìŒ, POSTëŠ” Body ìˆìŒ)

### **Java ê¸°ìˆ :**

- `HttpServletRequest.getParameter()`
- `HttpServletRequest.getInputStream()` (RequestBodyìš©)
- **ì •ê·œí‘œí˜„ì‹** ê¸°ì´ˆ (URL íŒ¨í„´ ë§¤ì¹­ìš©)
- **Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬** ë˜ëŠ” ê°„ë‹¨í•œ JSON íŒŒì‹±

---

## ğŸ’» êµ¬í˜„ ë‚´ìš© (40ë¶„)

### **1ë‹¨ê³„: ì–´ë…¸í…Œì´ì…˜ ì •ì˜ (5ë¶„)**

```java
// HTTP ë©”ì†Œë“œë³„ ì–´ë…¸í…Œì´ì…˜
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface GetMapping {
    String value();
}

@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface PostMapping {
    String value();
}

@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface PutMapping {
    String value();
}

// íŒŒë¼ë¯¸í„° ì²˜ë¦¬ ì–´ë…¸í…Œì´ì…˜
@Target(ElementType.PARAMETER)
@Retention(RetentionPolicy.RUNTIME)
public @interface RequestParam {
    String value();
    boolean required() default true;
}

@Target(ElementType.PARAMETER)
@Retention(RetentionPolicy.RUNTIME)
public @interface PathVariable {
    String value();
}

@Target(ElementType.PARAMETER)
@Retention(RetentionPolicy.RUNTIME)
public @interface RequestBody {
}

```

### **2ë‹¨ê³„: URL íŒ¨í„´ ë§¤ì¹­ ê°•í™” (10ë¶„)**

```java
// URL íŒ¨í„´ê³¼ ì‹¤ì œ URL ë§¤ì¹­í•˜ëŠ” ìœ í‹¸ë¦¬í‹°
public class UrlMatcher {

    // /users/{id} íŒ¨í„´ê³¼ /users/123 ì‹¤ì œ URL ë§¤ì¹­
    public static boolean matches(String pattern, String url) {
        String regex = pattern.replaceAll("\\{[^}]+\\}", "([^/]+)");
        // /users/{id} â†’ /users/([^/]+) ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ë³€í™˜
        return url.matches(regex);
    }

    // ì‹¤ì œ URLì—ì„œ PathVariable ê°’ ì¶”ì¶œ
    public static Map<String, String> extractPathVariables(String pattern, String url) {
        Map<String, String> variables = new HashMap<>();

        // {id} ê°™ì€ ë³€ìˆ˜ëª… ì°¾ê¸°
        Pattern varPattern = Pattern.compile("\\{([^}]+)\\}");
        Matcher varMatcher = varPattern.matcher(pattern);

        // ì‹¤ì œ ê°’ ì¶”ì¶œí•˜ëŠ” ì •ê·œí‘œí˜„ì‹
        String regex = pattern.replaceAll("\\{[^}]+\\}", "([^/]+)");
        Pattern urlPattern = Pattern.compile(regex);
        Matcher urlMatcher = urlPattern.matcher(url);

        if (urlMatcher.matches()) {
            int groupIndex = 1;
            varMatcher.reset();
            while (varMatcher.find()) {
                String varName = varMatcher.group(1); // {id}ì—ì„œ id ì¶”ì¶œ
                String value = urlMatcher.group(groupIndex++); // ì‹¤ì œ ê°’
                variables.put(varName, value);
            }
        }

        return variables;
    }
}

```

### **3ë‹¨ê³„: í–¥ìƒëœ DispatcherServlet (20ë¶„)**

```java
public class EnhancedDispatcherServlet extends HttpServlet {
    private Map<String, Object> controllers = new HashMap<>();
    private List<HandlerMapping> handlerMappings = new ArrayList<>();

    // í•¸ë“¤ëŸ¬ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í´ë˜ìŠ¤
    public static class HandlerMapping {
        String httpMethod;    // GET, POST, PUT, DELETE
        String urlPattern;    // /users/{id}
        Method method;        // ì‹¤ì œ Java ë©”ì†Œë“œ
        Object controller;    // ì»¨íŠ¸ë¡¤ëŸ¬ ì¸ìŠ¤í„´ìŠ¤

        // getter, setter, constructor...
    }

    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp)
            throws ServletException, IOException {

        String httpMethod = req.getMethod();  // GET, POST, PUT, DELETE
        String uri = req.getRequestURI();     // /users/123

        // 1. ì ì ˆí•œ í•¸ë“¤ëŸ¬ ì°¾ê¸°
        HandlerMapping handler = findHandler(httpMethod, uri);

        if (handler == null) {
            resp.getWriter().write("Handler not found for: " + httpMethod + " " + uri);
            return;
        }

        try {
            // 2. ë©”ì†Œë“œ íŒŒë¼ë¯¸í„° ì¤€ë¹„
            Object[] methodArgs = prepareMethodArguments(handler, req, uri);

            // 3. ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì†Œë“œ ì‹¤í–‰
            Object result = handler.method.invoke(handler.controller, methodArgs);

            // 4. ì‘ë‹µ ì²˜ë¦¬
            resp.setContentType("application/json;charset=UTF-8");
            resp.getWriter().write(String.valueOf(result));

        } catch (Exception e) {
            resp.getWriter().write("Error: " + e.getMessage());
            e.printStackTrace();
        }
    }

    private HandlerMapping findHandler(String httpMethod, String uri) {
        for (HandlerMapping mapping : handlerMappings) {
            if (mapping.httpMethod.equals(httpMethod) &&
                UrlMatcher.matches(mapping.urlPattern, uri)) {
                return mapping;
            }
        }
        return null;
    }

    // ğŸ”¥ í•µì‹¬ ë¡œì§: ë©”ì†Œë“œ íŒŒë¼ë¯¸í„° ìë™ ì¤€ë¹„
    private Object[] prepareMethodArguments(HandlerMapping handler,
                                          HttpServletRequest req, String uri) throws Exception {

        Method method = handler.method;
        Parameter[] parameters = method.getParameters();
        Object[] args = new Object[parameters.length];

        // PathVariable ê°’ë“¤ ë¯¸ë¦¬ ì¶”ì¶œ
        Map<String, String> pathVars = UrlMatcher.extractPathVariables(
            handler.urlPattern, uri);

        for (int i = 0; i < parameters.length; i++) {
            Parameter param = parameters[i];

            if (param.isAnnotationPresent(RequestParam.class)) {
                // @RequestParam ì²˜ë¦¬
                RequestParam annotation = param.getAnnotation(RequestParam.class);
                String paramName = annotation.value();
                String paramValue = req.getParameter(paramName);

                args[i] = convertToType(paramValue, param.getType());

            } else if (param.isAnnotationPresent(PathVariable.class)) {
                // @PathVariable ì²˜ë¦¬
                PathVariable annotation = param.getAnnotation(PathVariable.class);
                String varName = annotation.value();
                String varValue = pathVars.get(varName);

                args[i] = convertToType(varValue, param.getType());

            } else if (param.isAnnotationPresent(RequestBody.class)) {
                // @RequestBody ì²˜ë¦¬ (JSON)
                String jsonBody = readRequestBody(req);
                args[i] = parseJson(jsonBody, param.getType());
            }
        }

        return args;
    }

    // íƒ€ì… ë³€í™˜ ìœ í‹¸ë¦¬í‹°
    private Object convertToType(String value, Class<?> targetType) {
        if (value == null) return null;

        if (targetType == String.class) return value;
        if (targetType == Integer.class || targetType == int.class)
            return Integer.parseInt(value);
        if (targetType == Long.class || targetType == long.class)
            return Long.parseLong(value);
        if (targetType == Boolean.class || targetType == boolean.class)
            return Boolean.parseBoolean(value);

        return value; // ê¸°ë³¸ê°’
    }

    // Request Body ì½ê¸°
    private String readRequestBody(HttpServletRequest req) throws IOException {
        StringBuilder sb = new StringBuilder();
        try (BufferedReader reader = req.getReader()) {
            String line;
            while ((line = reader.readLine()) != null) {
                sb.append(line);
            }
        }
        return sb.toString();
    }

    // ê°„ë‹¨í•œ JSON íŒŒì‹± (ì‹¤ì œë¡œëŠ” Jackson ì‚¬ìš©)
    private Object parseJson(String json, Class<?> targetType) {
        // ë§¤ìš° ê°„ë‹¨í•œ User í´ë˜ìŠ¤ìš© JSON íŒŒì‹±
        if (targetType.getSimpleName().equals("User")) {
            User user = new User();
            // {"name":"john","age":25} ê°™ì€ ê°„ë‹¨í•œ JSON íŒŒì‹±
            // ì‹¤ì œë¡œëŠ” Jackson ObjectMapper ì‚¬ìš©
            json = json.replaceAll("[{}\"\\s]", "");
            String[] pairs = json.split(",");

            for (String pair : pairs) {
                String[] keyValue = pair.split(":");
                if (keyValue.length == 2) {
                    String key = keyValue[0];
                    String value = keyValue[1];

                    if ("name".equals(key)) user.setName(value);
                    if ("age".equals(key)) user.setAge(Integer.parseInt(value));
                }
            }
            return user;
        }
        return null;
    }
}

```

### **4ë‹¨ê³„: í…ŒìŠ¤íŠ¸ìš© ì»¨íŠ¸ë¡¤ëŸ¬ (5ë¶„)**

```java
@Controller
public class UserController {

    @Autowired
    private UserService userService;

    // 1. RequestParam í…ŒìŠ¤íŠ¸
    @GetMapping("/users")
    public String getUsers(@RequestParam String name,
                          @RequestParam int age) {
        return "{\"message\": \"Found user: " + name + ", age: " + age + "\"}";
    }

    // 2. PathVariable í…ŒìŠ¤íŠ¸
    @GetMapping("/users/{id}")
    public String getUserById(@PathVariable Long id) {
        return "{\"message\": \"User ID: " + id + "\"}";
    }

    // 3. RequestBody í…ŒìŠ¤íŠ¸
    @PostMapping("/users")
    public String createUser(@RequestBody User user) {
        return "{\"message\": \"Created user: " + user.getName() + "\"}";
    }

    // 4. ë³µí•© í…ŒìŠ¤íŠ¸ (PathVariable + RequestParam)
    @PutMapping("/users/{id}")
    public String updateUser(@PathVariable Long id,
                           @RequestParam String status) {
        return "{\"message\": \"Updated user " + id + " to " + status + "\"}";
    }
}

// ê°„ë‹¨í•œ User DTO
public class User {
    private String name;
    private int age;

    // getter, setter, constructor...
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    public int getAge() { return age; }
    public void setAge(int age) { this.age = age; }
}

```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ (ë§¤ì¼ í™•ì¸)

### **ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸:**

```bash
# 1. RequestParam í…ŒìŠ¤íŠ¸
GET http://localhost:8080/users?name=john&age=25

# 2. PathVariable í…ŒìŠ¤íŠ¸
GET http://localhost:8080/users/123

```

### **Postman í…ŒìŠ¤íŠ¸:**

```bash
# 3. RequestBody í…ŒìŠ¤íŠ¸
POST http://localhost:8080/users
Content-Type: application/json
{
  "name": "john",
  "age": 25
}

# 4. ë³µí•© í…ŒìŠ¤íŠ¸
PUT http://localhost:8080/users/123?status=active

```

### **ì˜ˆìƒ ì‘ë‹µ:**

```json
// Case 1
{"message": "Found user: john, age: 25"}

// Case 2
{"message": "User ID: 123"}

// Case 3
{"message": "Created user: john"}

// Case 4
{"message": "Updated user 123 to active"}

```

---

## ğŸ”‘ ì£¼ìš” í•™ìŠµ í‚¤ì›Œë“œ

### **í•„ìˆ˜ (â­â­â­)**

- **@RequestParam, @PathVariable, @RequestBody**
- **HTTP Method êµ¬ë¶„** (GET, POST, PUT, DELETE)
- **URL íŒ¨í„´ ë§¤ì¹­** (ì •ê·œí‘œí˜„ì‹)
- **íŒŒë¼ë¯¸í„° íƒ€ì… ë³€í™˜** (String â†’ int, Long)

### **ì¤‘ìš” (â­â­)**

- **JSON íŒŒì‹±** ê¸°ì´ˆ
- **Request Body ì½ê¸°** (`BufferedReader`)
- **HTTP ìš”ì²­/ì‘ë‹µ** êµ¬ì¡°

---

## ğŸ¯ ì£¼ì°¨ ì™„ë£Œ ê¸°ì¤€

### **âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸:**

- [ ] `GET /users?name=john&age=25` ë™ì‘
- [ ] `GET /users/123` ë™ì‘
- [ ] `POST /users` + JSON Body ë™ì‘
- [ ] `PUT /users/123?status=active` ë™ì‘
- [ ] ëª¨ë“  íŒŒë¼ë¯¸í„° íƒ€ì… ë³€í™˜ ì •ìƒ ì‘ë™
- [ ] ì—ëŸ¬ ìƒí™© ì²˜ë¦¬ (íŒŒë¼ë¯¸í„° ëˆ„ë½, íƒ€ì… ì˜¤ë¥˜ ë“±)
