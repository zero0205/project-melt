## 📋 3주차 목표

**Java 기본 어노테이션을 이용해서 스프링 스타일 어노테이션을 직접 만들고, Reflection으로 동적 객체 생성하기**

---

## 🛠️ 해야 할 일 체크리스트

### ✅ 1단계: 커스텀 어노테이션 정의하기

```java
// @Component 어노테이션 직접 만들기
@Retention(RetentionPolicy.RUNTIME)  // Java 제공
@Target(ElementType.TYPE)           // Java 제공
public @interface Component {        // 내가 만드는 것!
    String value() default "";
}

// @Service 어노테이션 직접 만들기
@Component  // 내가 만든 @Component 사용
public @interface Service {
    String value() default "";
}

// @Repository 어노테이션도 만들어보기 (추가)
@Component
public @interface Repository {
    String value() default "";
}
```

### ✅ 2단계: 비즈니스 클래스에 내가 만든 어노테이션 붙이기

```java
@Component  // 내가 만든 어노테이션 사용
public class UserRepository {
    public void save() {
        System.out.println("사용자 저장 완료!");
    }
}

@Service    // 내가 만든 어노테이션 사용
public class UserService {
    public void processUser() {
        System.out.println("사용자 처리 중...");
    }
}

// 어노테이션 없는 클래스 (테스트용)
public class RegularClass {
    public void doSomething() {
        System.out.println("일반 클래스");
    }
}
```

### ✅ 3단계: Reflection으로 어노테이션 인식하는 컨테이너 만들기

```java
public class AnnotationContainer {
    private Map<String, Object> beans = new HashMap<>();

    // 클래스명으로 Bean 등록 시도
    public void registerBean(String className) {
        try {
            // 1. 클래스 정보 로드
            Class<?> clazz = Class.forName(className);

            // 2. 내가 만든 @Component 어노테이션 확인
            if (clazz.isAnnotationPresent(Component.class)) {
                // 3. 객체 생성
                Object instance = clazz.getDeclaredConstructor().newInstance();

                // 4. 컨테이너에 저장
                String beanName = clazz.getSimpleName();
                beans.put(beanName, instance);

                System.out.println("✅ " + beanName + " Bean 등록 완료!");
            } else {
                System.out.println("❌ " + className + "에는 @Component가 없어서 등록 안함");
            }
        } catch (Exception e) {
            System.out.println("🚨 등록 실패: " + e.getMessage());
        }
    }

    // Bean 조회
    public Object getBean(String beanName) {
        return beans.get(beanName);
    }

    // 등록된 모든 Bean 목록 출력
    public void printAllBeans() {
        System.out.println("\n=== 등록된 Bean 목록 ===");
        beans.keySet().forEach(name ->
            System.out.println("- " + name)
        );
    }
}
```

### ✅ 4단계: 테스트 메인 클래스 만들기

```java
public class Main {
    public static void main(String[] args) {
        System.out.println("🚀 3주차 스프링 구현 테스트 시작!\n");

        AnnotationContainer container = new AnnotationContainer();

        // 각 클래스를 등록 시도해보기
        container.registerBean("com.example.UserRepository");  // 성공
        container.registerBean("com.example.UserService");     // 성공
        container.registerBean("com.example.RegularClass");    // 실패 (어노테이션 없음)

        // 등록된 Bean 목록 확인
        container.printAllBeans();

        // 실제로 Bean 사용해보기
        System.out.println("\n=== Bean 사용 테스트 ===");
        UserRepository repo = (UserRepository) container.getBean("UserRepository");
        if (repo != null) {
            repo.save();
        }

        UserService service = (UserService) container.getBean("UserService");
        if (service != null) {
            service.processUser();
        }

        System.out.println("\n✅ 3주차 구현 완료!");
    }
}
```

---

## 🎯 최종 확인사항

### 동작해야 하는 것들:

1. **내가 만든 `@Component` 어노테이션**이 제대로 정의되었나?
2. **클래스에 어노테이션을 붙였을 때** Reflection으로 인식되나?
3. **어노테이션 있는 클래스는 Bean 등록**, 없는 클래스는 무시되나?
4. **등록된 Bean을 가져와서 메소드 호출**이 되나?

### 예상 출력:

```
🚀 3주차 스프링 구현 테스트 시작!

✅ UserRepository Bean 등록 완료!
✅ UserService Bean 등록 완료!
❌ com.example.RegularClass에는 @Component가 없어서 등록 안함

=== 등록된 Bean 목록 ===
- UserRepository
- UserService

=== Bean 사용 테스트 ===
사용자 저장 완료!
사용자 처리 중...

✅ 3주차 구현 완료!
```

---

## 💡 추가로 해볼 만한 것들 (시간 여유 있으면)

### 심화 기능:

- `@Component`의 `value` 속성 활용해보기
- 여러 패키지의 클래스들 테스트해보기
- Bean 이름을 커스터마이징해보기

### 에러 처리:

- 존재하지 않는 클래스명 입력시 처리
- 생성자가 없는 클래스 처리
- 중복 Bean 이름 처리

---

## 🚨 주의사항

1. **패키지명 정확히 쓰기**: `com.example.UserRepository` (실제 패키지 구조에 맞게)
2. **public 생성자 있는지 확인**: `newInstance()` 호출 가능해야 함
3. **import 문 빼먹지 않기**: `java.lang.annotation.*` 등
4. **클래스 파일 경로 확인**: `Class.forName()`이 찾을 수 있어야 함
